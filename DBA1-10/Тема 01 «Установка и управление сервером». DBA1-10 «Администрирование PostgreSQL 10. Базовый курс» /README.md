# Установка и управление сервером
***

## Установка пакета

* Готовые пакеты - предпочтительный способ.
  * [c сайта www.postgresql.org](https://www.postgresql.org/download/)
  * [c сайта postgrespro.ru](https://postgrespro.ru/products/download)
  

* Linux (Red Hat, CentOS, Debian, Ubuntu и другие)
  * входит в дистрибутивы ОС
  * репозиторий (yum, apt) или пакеты RPM, DEB


* FreeBSD, OpenBSD
  * пакеты из Ports and Package Collection

Mac OS X

Windows

Предпочтительным вариантом является использование готовых
пакетов, так как в этом случае получается понятная, поддерживаемая и
легко обновляемая установка.
Пакеты существуют для большинства широко распространенных
систем, но в каждой из них имеются свои особенности установки,
которые здесь не рассматриваются.
***

## Исходные коды

* Установка из исходных кодов
  * собрать стабильную версию сервера
  * со специфичными параметрами или на специфичной архитектуре
  * [https://ftp.postgresql.org/pub/source/v10.0/postgresql-10.0.tar.gz](https://ftp.postgresql.org/pub/source/v10.0/postgresql-10.0.tar.gz)


* Установка из репозитория git
  * собрать текущую версию сервера
  * в первую очередь для разработчиков ядра, требует более широкого
  * набора инструментов
  * [git://git.postgresql.org/git/postgresql.git](git://git.postgresql.org/git/postgresql.git)

Полезно иметь представление о том, как происходит установка из
исходных кодов, чтобы в случае необходимости можно было собрать
PostgreSQL с нестандартными параметрами или на специфичной
архитектуре.
По [адресу](https://www.postgresql.org/ftp/source/v10.0/) доступен
исходный код версии 10.0 в двух вариантах (`gzip` и `bzip2`).
В виртуальной машине необходимый файл уже находится в домашнем
каталоге пользователя `postgres`.
При установке из репозитория `git` требуется более широкий набор
инструментов. Например, лексический и синтаксический анализатор
сделан с помощью Flex и Bison, и в `git` хранятся именно исходные коды
для этих инструментов. При сборке из них генерируются файлы на Си,
которые затем компилируются. При этом в архиве с исходными кодами
находится уже сгенерированные файлы Си.

***
## Необходимое ПО

* Обязательно
  * tar, gzip/bzip2, GNU make, компилятор Си (C89)
  * Используются, но можно отключить
  * библиотеки GNU Readline, zlib
  

* Дополнительно
  * языки программирования Perl, Python, Tcl
  * для использования PL/Perl, PL/Python, PL/Tcl
  * Kerberos, OpenSSL, OpenLDAP, PAM
  * для аутентификации и шифрования
  

* Отдельные инструменты при сборке из репозитория git


Для сборки требуется ряд программ и утилит.
Библиотека `readline` дает возможность редактировать командную
строку, пользоваться историей команд и автодополнением. В серверной
инсталляции может быть и не нужна, если не предполагается запускать
`psql` в консоли.
Библиотека `zlib` используется для сжатия архивов `pg_dump`

*** 
## Практика
***
### Установка postgres
```shell
user$ tar xzf ~/Загрузки/postgresql-14.0.tar.gz

user$ cd postgresql-14.0
```

### Создание конфигурации
```shell
# (!НЕОБЯЗАТЕЛЬНО)
# Если требуется повторно выполнить конфигурацию, например c другими 
# параметрами, то предварительно нужно очистить результаты предыдущего запроса:

user$ make distclean
```

```shell
# в команде configure можно указать различные параметры конфигуарции:
# --prefix -  каталог установки, по умолчанию /usr/local/pgsql
# --enable-debug - для включения отладочной информации

user$ ./configure
checking build system type... x86_64-pc-linux-gnu
checking host system type... x86_64-pc-linux-gnu
checking which template to use... linux
...
config.status: linking src/backend/port/sysv_shmem.c to src/backend/port/pg_shmem.c
config.status: linking src/include/port/linux.h to src/include/pg_config_os.h
config.status: linking src/makefiles/Makefile.linux to src/Makefile.port
```


